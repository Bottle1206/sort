<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>S-堆</title>
  </head>
  <style type="text/css">
    h1{ text-align: center }
    #app{
      text-align: center
    }
    a {
      padding: 10px;
      display: block;
    }
    ul {
      margin: 0;
      padding: 0;
      list-style: none;
    }
    li{
      text-align: left
    }
    li > label{
      display: inline-block;
      width: 50%;
      text-align: right;
    }
  </style>
  <body>
    <div id="app">
      <h1>堆排序</h1>
      <img src="img/heap1.gif">
      <img src="img/heap2.gif">
      <a  target="_blank" href="https://www.cnblogs.com/chengxiao/p/6129630.html">图解堆排序</a>
      <ul>
        <li>
          <label>最后一个非叶子节点：</label> length/2 - 1
        </li>
        <li>
          <label>i非叶子节点：</label> 左子节点： 2i + 1; 右子节点： 2i + 2
        </li>
      </ul>
    </div>
  </body>
  <script>
    const list = [6, 5, 1, 3, 8, 7, 2, 4];

    function heapSort(list) {
      const len = list.length;
      for (let i=len; i>1; i--) {
        oneRound(list, i);
      }
      return list;
    }

    function oneRound(list, len) {
      const lastNotLeaf = Math.floor(len/2 - 1);

      for (let i=lastNotLeaf; i>=0; i--) {
        adjust(list, i, len)
      }
      swap(list, len - 1, 0)
    }

    function adjust(list, i, len) {
      let k = 2*i + 1;
      if (k+1 < len && list[k] < list[k+1]) {
        k++
      }
      if (list[k] > list[i]) swap(list, k, i);
    }

    function swap(list, k, i) {
      const temp = list[k];
      list[k] = list[i];
      list[i] = temp;
    }

    console.log(heapSort(list))
  </script>
</html>
